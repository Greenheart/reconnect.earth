import{c as y,f as C,d as Z,e as le,g as ce}from"../chunks/xPY292ll.js";import"../chunks/B2s3zujU.js";import{i as P,a as D,c as ue,o as ve,f as pe,b as xe,d as de,T as we,e as he,B as U,L as _e,X as ge,A as be,r as ye,g as Se,h as $,j as ke}from"../chunks/DDOVym-n.js";import{ap as Te,K as Ee,z as Le,L as Ie,B as X,Q as B,R as Q,G,V as v,T as p,g as e,U as x,ao as K,a as Ae,ah as fe,an as j,a5 as L,aq as Ce,a4 as ee}from"../chunks/BRPo_w0I.js";import{i as W,c as te}from"../chunks/3vVwO9Q5.js";import{s as O}from"../chunks/VwdBeC22.js";import{B as Ne,p as me}from"../chunks/DiJCjSrw.js";import{d as Y,e as J,f as Me,L as je,C as Re,M as Be,g as Oe,r as Pe,a as H,h as We,I as ae,i as ze,j as re,k as oe,l as ie}from"../chunks/CnrJOlrr.js";import{b as q}from"../chunks/BenNYi6Y.js";import{g as ne}from"../chunks/DlhQ1ghF.js";function Fe(w,t,a){Le&&Ie();var i=new Ne(w),s=!Te();Ee(()=>{var o=t();s&&o!==null&&typeof o=="object"&&(o={}),i.ensure(o,a)})}var Ve=C("<!> <!>",1),Xe=C('<h2><!> </h2> <p class="2xs:text-base xs:text-lg pt-2 text-sm whitespace-pre-wrap"> </p>',1);function Ge(w,t){X(t,!0);var a=Xe(),i=B(a),s=p(i);Fe(s,()=>t.reflectionStep,g=>{var k=Ve(),I=B(k);{var _=m=>{const l=K(()=>je[t.reflectionStep.i]);var d=Z(),h=B(d);te(h,()=>e(l),(b,u)=>{u(b,{get class(){return`-mb-0.5 size-6 ${Me[t.reflectionStep.i].text??""}`}})}),y(m,d)};W(I,m=>{P(t.reflectionStep)&&m(_)})}var T=v(I,2);{var N=m=>{const l=K(()=>Re);var d=Z(),h=B(d);te(h,()=>e(l),(b,u)=>{u(b,{class:"-mb-0.5 size-6 text-emerald-400"})}),y(m,d)};W(T,m=>{D(t.reflectionStep)&&m(N)})}y(g,k)});var o=v(s);x(i);var f=v(i,2),S=p(f,!0);x(f),Q(g=>{J(i,1,g),O(o,` ${t.reflectionStep.title??""}`),O(S,t.reflectionStep.text)},[()=>Y(["xs:text-2xl flex items-center justify-center gap-2 text-lg font-normal normal-case sm:text-3xl",P(t.reflectionStep)?t.reflectionStep.colors.text:"text-emerald-400"])]),y(w,a),G()}let R=Be,V=Oe,Ue=1;var He=C('<span> </span> <div role="tooltip" id="tooltip" class="absolute top-0 left-0 hidden max-w-max rounded-md bg-black px-2 py-1.5 text-sm"> <div class="arrow absolute h-2 w-2 rotate-45 bg-black"></div></div> <input type="range" aria-describedby="tooltip"/> <span> </span>',1),qe=C('<div class="slider xs:h-6 xs:text-xl flex h-4 w-full max-w-md min-w-40 items-center gap-4 px-4 text-lg select-none"><!></div>');function De(w,t){X(t,!0);let a=me(t,"lifewheel",15),i=j(void 0),s=j(void 0),o=j(void 0);const f=l=>(l-R)*100/(V-R),S=l=>{e(i)&&e(s)&&e(o)&&ue(e(i),e(s),{placement:"top",middleware:[ve(18),pe(),xe({element:e(o)})]}).then(({x:d,y:h,placement:b,middlewareData:u})=>{if(!(e(i)&&e(s)&&e(o)))return;const E=e(i).offsetWidth-32;e(s).style.transform=`translate(${d-E/2+E*f(l)/100}px, ${h}px)`;const{x:A,y:c}=u.arrow,M={top:"bottom",right:"left",bottom:"top",left:"right"}[b.split("-")[0]];Object.assign(e(o).style,{left:A!==null?`${A}px`:"",top:c!==null?`${c}px`:"",right:"",bottom:"",[M]:"-4px"})})};let g;const k=()=>{window.clearTimeout(g),e(s)&&(e(s).style.display="block"),S(a()[t.reflectionStep.i])},I=(l=400)=>{g=window.setTimeout(()=>{e(s)&&(e(s).style.display="")},l)},_=()=>{k(),I()};Ae(()=>{S(a()[t.reflectionStep.i])});var T=qe();ce("keydown",fe.body,l=>{const d=document.activeElement?.className.includes("input");d&&l.key.includes("Arrow")?_():!d&&P(t.reflectionStep)&&(l.key==="ArrowDown"?(a(a()[t.reflectionStep.i]=Math.max(R,a()[t.reflectionStep.i]-1),!0),_()):l.key==="ArrowUp"&&(a(a()[t.reflectionStep.i]=Math.min(V,a()[t.reflectionStep.i]+1),!0),_()))});var N=p(T);{var m=l=>{var d=He(),h=B(d),b=p(h,!0);x(h);var u=v(h,2),E=p(u),A=v(E);q(A,r=>L(o,r),()=>e(o)),x(u),q(u,r=>L(s,r),()=>e(s));var c=v(u,2);Pe(c),H(c,"step",Ue),c.__keydown=r=>{r.key.includes("Arrow")&&_()},c.__pointerdown=k,c.__pointerup=()=>I(),q(c,r=>L(i,r),()=>e(i));var M=v(c,2),n=p(M,!0);x(M),Q(r=>{O(b,R),O(E,`${a()[t.reflectionStep.i]??""} `),H(c,"min",R),H(c,"max",V),J(c,1,Y([t.sliderClass,"h-4 min-w-40 flex-1 cursor-ew-resize touch-pan-x rounded-full bg-stone-800 bg-linear-to-br bg-no-repeat shadow-sm",t.reflectionStep.colors.from,t.reflectionStep.colors.to])),We(c,r),O(n,V)},[()=>`background-size: ${f(a()[t.reflectionStep.i])}% 100%`]),de(c,()=>a()[t.reflectionStep.i],r=>a(a()[t.reflectionStep.i]=r,!0)),y(l,d)};W(N,l=>{P(t.reflectionStep)&&l(m)})}x(T),y(w,T),G()}le(["keydown","pointerdown","pointerup"]);var Ke=C(`<div class="autogrow svelte-1w1i9eu"><textarea rows="2" cols="42" maxlength="300" placeholder="Write your reflection...">
    </textarea></div>`);function Qe(w,t){X(t,!0);let a=me(t,"value",15);var i=Ke(),s=p(i);Ce(s),s.__input=o=>{o.currentTarget.parentNode.dataset.content=o.currentTarget.value},x(i),Q(()=>J(s,1,Y(t.class),"svelte-1w1i9eu")),de(s,a),y(w,i),G()}le(["input"]);const se="comment-textarea";var Ye=C('<div class="flex max-w-md min-w-40 justify-between pb-4"><!></div>'),Je=C('<div class="mx-auto grid max-h-[calc(100vh-4rem)] max-w-(--breakpoint-md) grid-rows-[min-content_1fr_min-content_min-content] justify-items-center gap-4 sm:gap-8"><!> <!> <div class="flex max-w-lg grow flex-col items-center justify-end px-4"><div class="2xs:h-48 xs:h-52 h-40"><!></div> <!></div> <!> <div class="flex w-full max-w-md min-w-40 justify-between px-4 pb-4"><!> <div class="grow"></div> <!></div></div>');function Ze(w,t){X(t,!0);let a=j(ee(ae)),i=j(ee(ze));const s=we.of(()=>ae,{duration:400,easing:he});let o=j(0),f=K(()=>re[e(o)]);const S=()=>e(o)>=1,g=()=>{S()&&L(o,e(o)-1)},k=async()=>{e(o)===re.length-1?(ye.add(Se(e(a),e(i))),await ne($("/"))):(L(o,e(o)+1),P(e(f))&&e(a)[e(f).i]===0&&L(a,e(a).map((n,r)=>r===e(f).i?ie:n),!0))};async function I(){const n=e(a).some(r=>r>0&&r!==ie)||e(i).length>0;(!n||n&&confirm("Are you sure you want to abort this reflection and lose your progress?"))&&await ne($("/"))}var _=Je();ce("keyup",fe.body,n=>{const r=document.activeElement?.className?.includes(se),z=document.activeElement?.className?.includes(oe),F=D(e(f));!z&&(!F||!r)&&(n.key==="ArrowLeft"?S()&&g():n.key==="ArrowRight"&&(F&&e(i).trim().length||k()))});var T=p(_);U(T,{onclick:I,"aria-label":"Abort reflection and go back to main menu",class:"absolute top-4 right-4 h-12! w-12! border-emerald-400/5!",variant:"roundGhost",children:(n,r)=>{ge(n,{})},$$slots:{default:!0}});var N=v(T,2);_e(N,{class:"max-w-sm 2xl:max-w-md",get tweenedLifewheel(){return s},get data(){return e(a)}});var m=v(N,2),l=p(m),d=p(l);Ge(d,{get reflectionStep(){return e(f)}}),x(l);var h=v(l,2);{var b=n=>{var r=Ye(),z=p(r);Qe(z,{class:se,get value(){return e(i)},set value(F){L(i,F,!0)}}),x(r),y(n,r)};W(h,n=>{D(e(f))&&n(b)})}x(m);var u=v(m,2);De(u,{get reflectionStep(){return e(f)},get sliderClass(){return oe},get lifewheel(){return e(a)},set lifewheel(n){L(a,n,!0)}});var E=v(u,2),A=p(E);{var c=n=>{U(n,{variant:"roundOutline",onclick:g,"aria-label":"Show previous step",children:(r,z)=>{ke(r,{})},$$slots:{default:!0}})};W(A,n=>{S()&&n(c)})}var M=v(A,4);U(M,{variant:"roundSolid",onclick:k,"aria-label":"Show next step",children:(n,r)=>{be(n,{})},$$slots:{default:!0}}),x(E),x(_),y(w,_),G()}function dt(w){Ze(w,{})}export{dt as component};
